<!DOCTYPE html>
<html lang="en-us">
<head>
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-brands-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-regular-400.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/font-awesome/webfonts/fa-solid-900.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <link rel="preload" href="/lib/JetBrainsMono/web/woff2/JetBrainsMono-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
  <script type="text/javascript" src="https://latest.cactus.chat/cactus.js"></script>
  <link rel="stylesheet" href="https://latest.cactus.chat/style.css" type="text/css">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title> Scatterplot in regl | Saaientist</title>
  <link rel = 'canonical' href = '/posts/scatterplot_in_regl/'>
  <meta name="description" content="My external memory. See http://saaientist.blogspot.com for old posts.">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,follow">
  <meta name="googlebot" content="index,follow,snippet,archive">
  <meta property="og:title" content="Scatterplot in regl" />
<meta property="og:description" content="During our biological data visualisation workshop at the EBI I was made aware of a javascript library that makes it straightforward to create scatterplots of large datasets. How large? The demo at https://flekschas.github.io/regl-scatterplot/ includes an example of 20M datapoints. That library is regl-scatterplot which is available at https://github.com/flekschas/regl-scatterplot, and based on regl which &#34;simplifies WebGL programming by removing as much shared state as it can get away with&#34;.
  Figure 1." />
<meta property="og:type" content="article" />
<meta property="og:url" content="/posts/scatterplot_in_regl/" />
<meta property="article:published_time" content="2023-05-17T17:45:00+02:00" />
<meta property="article:modified_time" content="2023-05-17T17:45:00+02:00" />

  <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Scatterplot in regl"/>
<meta name="twitter:description" content="During our biological data visualisation workshop at the EBI I was made aware of a javascript library that makes it straightforward to create scatterplots of large datasets. How large? The demo at https://flekschas.github.io/regl-scatterplot/ includes an example of 20M datapoints. That library is regl-scatterplot which is available at https://github.com/flekschas/regl-scatterplot, and based on regl which &#34;simplifies WebGL programming by removing as much shared state as it can get away with&#34;.
  Figure 1."/>

  
  
    
  
  
  <link rel="stylesheet" href="/css/styles.94f653e9e151e28067a7c5dbbc4600cbd5a3c721e79faaf971e523c40f3b249b8e4f20bb57810dfffa8d559ca5c140fd56eb4cd9c0853113ad08e66afdb08bdd.css" integrity="sha512-lPZT6eFR4oBnp8XbvEYAy9WjxyHnn6r5ceUjxA87JJuOTyC7V4EN//qNVZylwUD9VutM2cCFMROtCOZq/bCL3Q=="> 

  
  
  
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  

  
<link rel="icon" type="image/png" href="/images/favicon.ico" />

  
  
  
  
</head>

<body class="max-width mx-auto px3 ltr">
  <div class="content index py4">

  <div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;" aria-label="Top of Page"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li>
          <a class="icon" href=" /posts/reframe-vis-part2/" aria-label="Previous">
            <i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i>
          </a>
        </li>
        
        
        <li>
          <a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
            <i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i>
          </a>
        </li>
        <li>
          <a class="icon" href="#" aria-label="Share">
            <i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i>
          </a>
        </li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2fscatterplot_in_regl%2f" aria-label="Facebook">
      <i class="fab fa-facebook " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2fscatterplot_in_regl%2f&text=Scatterplot%20in%20regl" aria-label="Twitter">
      <i class="fab fa-twitter " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2fscatterplot_in_regl%2f&title=Scatterplot%20in%20regl" aria-label="Linkedin">
      <i class="fab fa-linkedin " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2fscatterplot_in_regl%2f&is_video=false&description=Scatterplot%20in%20regl" aria-label="Pinterest">
      <i class="fab fa-pinterest " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Scatterplot%20in%20regl&body=Check out this article: %2fposts%2fscatterplot_in_regl%2f" aria-label="Email">
      <i class="fas fa-envelope " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2fscatterplot_in_regl%2f&title=Scatterplot%20in%20regl" aria-label="Pocket">
      <i class="fab fa-get-pocket " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2fscatterplot_in_regl%2f&title=Scatterplot%20in%20regl" aria-label="reddit">
      <i class="fab fa-reddit " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2fscatterplot_in_regl%2f&name=Scatterplot%20in%20regl&description=During%20our%20biological%20data%20visualisation%20workshop%20at%20the%20EBI%20I%20was%20made%20aware%20of%20a%20javascript%20library%20that%20makes%20it%20straightforward%20to%20create%20scatterplots%20of%20large%20datasets.%20How%20large%3f%20The%20demo%20at%20https%3a%2f%2fflekschas.github.io%2fregl-scatterplot%2f%20includes%20an%20example%20of%2020M%20datapoints.%20That%20library%20is%20regl-scatterplot%20which%20is%20available%20at%20https%3a%2f%2fgithub.com%2fflekschas%2fregl-scatterplot%2c%20and%20based%20on%20regl%20which%20%22simplifies%20WebGL%20programming%20by%20removing%20as%20much%20shared%20state%20as%20it%20can%20get%20away%20with%22.%0a%20%20Figure%201." aria-label="Tumblr">
      <i class="fab fa-tumblr " aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2fscatterplot_in_regl%2f&t=Scatterplot%20in%20regl" aria-label="Hacker News">
      <i class="fab fa-hacker-news " aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>
    
    <div id="toc">
      
    </div>
    
  </span>
</div>


  <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
    <header>
      <h1 class="posttitle" itemprop="name headline">
        Scatterplot in regl
      </h1>
      <div class="meta">
        
        <div class="postdate">
          
          <time datetime="2023-05-17 17:45:00 &#43;0200 &#43;0200" itemprop="datePublished">2023-05-17</time>
          
        </div>
        
        
        
        
        <div class="article-tag">
            <i class="fas fa-tag"></i>
            
            
            <a class="tag-link" href="/tags/visualisation" rel="tag">visualisation</a>
            
             ,  
            <a class="tag-link" href="/tags/regl" rel="tag">regl</a>
            
             ,  
            <a class="tag-link" href="/tags/svelte" rel="tag">svelte</a>
            
        </div>
        
      </div>
    </header>

  
    
    <div class="content" itemprop="articleBody">
      <div class="paragraph">
<p>During our biological data visualisation workshop at the EBI I was made aware of a javascript library that makes it straightforward to create scatterplots of large datasets. How large? The demo at <a href="https://flekschas.github.io/regl-scatterplot/" class="bare">https://flekschas.github.io/regl-scatterplot/</a> includes an example of <strong>20M datapoints</strong>. That library is <code>regl-scatterplot</code> which is available at <a href="https://github.com/flekschas/regl-scatterplot" class="bare">https://github.com/flekschas/regl-scatterplot</a>, and based on <a href="https://github.com/regl-project/regl">regl</a> which "simplifies WebGL programming by removing as much shared state as it can get away with".</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/regl-scatterplot.gif" alt="regl scatterplot">
</div>
<div class="title">Figure 1. Image taken from <a href="https://github.com/flekschas/regl-scatterplot" class="bare">https://github.com/flekschas/regl-scatterplot</a></div>
</div>
<div class="paragraph">
<p><code>regl-scatterplot</code> uses the GPU to do this, but does have very specific restrictions. These mainly result from the fact that data to be plotted is encoded in an array of up to 4 elements, because they are actually encoded as R, G, B and A values. In addition, these values have to be rescaled between -1 and 1 <em>before</em> using them.</p>
</div>
<div class="paragraph">
<p>Below an example:</p>
</div>
<div class="paragraph">
<div class="title">+page.js</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">Papa</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;papaparse&#39;</span>

<span style="color:#66d9ef">export</span> <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">load</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">fetch</span> }) =&gt; {
  <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">fetchFlights</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">async</span> () =&gt; {
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">fetch</span>(<span style="color:#e6db74">&#39;http://vda-lab.github.io/assets/flights.csv&#39;</span>, {
      <span style="color:#a6e22e">headers</span><span style="color:#f92672">:</span> {
        <span style="color:#e6db74">&#39;Content-Type&#39;</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;text/csv&#39;</span>
    }})
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">csv_data</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">await</span> <span style="color:#a6e22e">res</span>.<span style="color:#a6e22e">text</span>()
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">csv_parsed</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">Papa</span>.<span style="color:#a6e22e">parse</span>(<span style="color:#a6e22e">csv_data</span>, {<span style="color:#a6e22e">header</span><span style="color:#f92672">:</span> <span style="color:#66d9ef">true</span>})

    <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">csv_parsed</span>.<span style="color:#a6e22e">data</span>
  }

  <span style="color:#66d9ef">return</span> {
    <span style="color:#a6e22e">flights</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">fetchFlights</span>()
  }
}
</code></pre></td></tr></table>
</div>
</div>
</div>
<div class="paragraph">
<div class="title">+page.svelte</div>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4">
<table style="border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">88
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">89
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">90
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">91
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">92
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">93
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">94
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">95
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">96
</span><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">97
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-html" data-lang="html">&lt;<span style="color:#f92672">script</span>&gt;
    <span style="color:#66d9ef">import</span> <span style="color:#a6e22e">createScatterplot</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;regl-scatterplot&#34;</span>;
    <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">scaleLinear</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;d3-scale&#34;</span>;
    <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">extent</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;d3-array&#34;</span>;
    <span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">onMount</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;svelte&#34;</span>;

    <span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">data</span> <span style="color:#f92672">=</span> [];

    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">width</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">800</span>;
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">height</span> <span style="color:#f92672">=</span> <span style="color:#ae81ff">400</span>;

    <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">xScale</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scaleLinear</span>().<span style="color:#a6e22e">domain</span>([<span style="color:#f92672">-</span><span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">180</span>]).<span style="color:#a6e22e">range</span>([<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>]);
    <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">yScale</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scaleLinear</span>().<span style="color:#a6e22e">domain</span>([<span style="color:#f92672">-</span><span style="color:#ae81ff">90</span>, <span style="color:#ae81ff">90</span>]).<span style="color:#a6e22e">range</span>([<span style="color:#f92672">-</span><span style="color:#ae81ff">1</span>, <span style="color:#ae81ff">1</span>]);
    <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">rScale</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">scaleLinear</span>()
        .<span style="color:#a6e22e">domain</span>(
            <span style="color:#a6e22e">extent</span>(
                <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">flights</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">d</span>) =&gt; {
                    <span style="color:#66d9ef">return</span> <span style="color:#f92672">+</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">distance</span>;
                })
            )
        )
        .<span style="color:#a6e22e">range</span>([<span style="color:#ae81ff">0</span>, <span style="color:#ae81ff">1</span>]);

    <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">points</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">flights</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">d</span>) =&gt; [
        <span style="color:#a6e22e">xScale</span>(<span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">from_long</span>),
        <span style="color:#a6e22e">yScale</span>(<span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">from_lat</span>),
        <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">from_country</span> <span style="color:#f92672">==</span> <span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">to_country</span> <span style="color:#f92672">?</span> <span style="color:#ae81ff">0</span> <span style="color:#f92672">:</span> <span style="color:#ae81ff">1</span>,
        <span style="color:#a6e22e">rScale</span>(<span style="color:#f92672">+</span><span style="color:#a6e22e">d</span>.<span style="color:#a6e22e">distance</span>),
    ]);
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">full_points</span> <span style="color:#f92672">=</span> {}
    <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">data</span>.<span style="color:#a6e22e">flights</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">d</span>,<span style="color:#a6e22e">i</span>) =&gt; {
        <span style="color:#a6e22e">full_points</span>[<span style="color:#a6e22e">i</span>] <span style="color:#f92672">=</span> <span style="color:#a6e22e">d</span>
    })
    <span style="color:#75715e">// $: console.log(points.map((d) =&gt; { return d[3]}))
</span><span style="color:#75715e"></span>
    <span style="color:#66d9ef">const</span> <span style="color:#a6e22e">dataFlow</span> <span style="color:#f92672">=</span> ({ <span style="color:#a6e22e">points</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">index</span> }) =&gt; {
        <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">value</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">index</span>; <span style="color:#75715e">// Array.from(index, (i) =&gt; points[i]);
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">canvas</span>.<span style="color:#a6e22e">dispatchEvent</span>(<span style="color:#66d9ef">new</span> <span style="color:#a6e22e">Event</span>(<span style="color:#e6db74">&#34;input&#34;</span>));
    }

    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">canvas</span>;
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">scatterplot</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">undefined</span>;
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">selectedPointIDs</span> <span style="color:#f92672">=</span> []
    <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">selectedPointID</span> <span style="color:#f92672">=</span> <span style="color:#66d9ef">undefined</span>
    <span style="color:#a6e22e">onMount</span>(() =&gt; {
        <span style="color:#a6e22e">scatterplot</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">createScatterplot</span>({
            <span style="color:#a6e22e">canvas</span>,
            <span style="color:#a6e22e">width</span>,
            <span style="color:#a6e22e">height</span>,
            <span style="color:#75715e">// opacityBy: &#39;density&#39;,
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">opacity</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">0.4</span>,
            <span style="color:#a6e22e">colorBy</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value1&#34;</span>,
            <span style="color:#a6e22e">pointColor</span><span style="color:#f92672">:</span> [<span style="color:#e6db74">&#34;#4682B4&#34;</span>, <span style="color:#e6db74">&#34;#ff0000&#34;</span>],
            <span style="color:#a6e22e">sizeBy</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;value2&#34;</span>,
            <span style="color:#a6e22e">pointSize</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">points</span>.<span style="color:#a6e22e">map</span>((<span style="color:#a6e22e">d</span>) =&gt; {
                <span style="color:#66d9ef">return</span> <span style="color:#a6e22e">d</span>[<span style="color:#ae81ff">3</span>] <span style="color:#f92672">*</span> <span style="color:#ae81ff">10</span>;
            }),
            <span style="color:#75715e">// cameraDistance: 1,
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// cameraRotation: Math.PI/4,
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// showReticle: true,
</span><span style="color:#75715e"></span>            <span style="color:#75715e">// reticleColor: &#34;rgba(1,0,0,1)&#34;,
</span><span style="color:#75715e"></span>            <span style="color:#a6e22e">pointOutlineWidth</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span>,
            <span style="color:#a6e22e">xScale</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">scaleLinear</span>().<span style="color:#a6e22e">domain</span>([<span style="color:#f92672">-</span><span style="color:#ae81ff">180</span>, <span style="color:#ae81ff">180</span>]).<span style="color:#a6e22e">range</span>([<span style="color:#f92672">-</span><span style="color:#ae81ff">2</span>, <span style="color:#ae81ff">2</span>]),
        });

        <span style="color:#75715e">// console.log(points)
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">scatterplot</span>.<span style="color:#a6e22e">draw</span>(<span style="color:#a6e22e">points</span>);

        <span style="color:#75715e">// dataFlow({ points: [] });
</span><span style="color:#75715e"></span>        <span style="color:#a6e22e">scatterplot</span>.<span style="color:#a6e22e">subscribe</span>(<span style="color:#e6db74">&#34;select&#34;</span>, (<span style="color:#a6e22e">d</span>) =&gt; { <span style="color:#a6e22e">selectedPointIDs</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">d</span> });
    });
    <span style="color:#75715e">// $: console.log(selectedPointIDs.points)
</span><span style="color:#75715e"></span>    <span style="color:#a6e22e">$</span><span style="color:#f92672">:</span> { <span style="color:#66d9ef">if</span> ( <span style="color:#a6e22e">selectedPointIDs</span>.<span style="color:#a6e22e">points</span> ) { 
        <span style="color:#a6e22e">selectedPointIDs</span>.<span style="color:#a6e22e">points</span>.<span style="color:#a6e22e">forEach</span>((<span style="color:#a6e22e">d</span>) =&gt; { <span style="color:#a6e22e">console</span>.<span style="color:#a6e22e">log</span>(<span style="color:#a6e22e">full_points</span>[<span style="color:#a6e22e">d</span>])})}}

&lt;/<span style="color:#f92672">script</span>&gt;

&lt;<span style="color:#f92672">h1</span>&gt;Flight dataset&lt;/<span style="color:#f92672">h1</span>&gt;
&lt;<span style="color:#f92672">canvas</span> <span style="color:#a6e22e">bind:this</span><span style="color:#f92672">=</span><span style="color:#e6db74">{canvas}</span> <span style="color:#960050;background-color:#1e0010">{</span><span style="color:#a6e22e">width</span><span style="color:#960050;background-color:#1e0010">}</span> <span style="color:#960050;background-color:#1e0010">{</span><span style="color:#a6e22e">height</span><span style="color:#960050;background-color:#1e0010">}</span> /&gt;

{#if selectedPointIDs.points}
&lt;<span style="color:#f92672">ul</span>&gt;
{#each selectedPointIDs.points as point_id}
&lt;<span style="color:#f92672">li</span>&gt;{JSON.stringify(full_points[point_id].from_airport)}&lt;/<span style="color:#f92672">li</span>&gt;
{/each}
&lt;/<span style="color:#f92672">ul</span>&gt;
{/if}


&lt;<span style="color:#f92672">style</span>&gt;
    <span style="color:#f92672">canvas</span> {
        <span style="color:#66d9ef">width</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
        <span style="color:#66d9ef">height</span>: <span style="color:#ae81ff">100</span><span style="color:#66d9ef">%</span>;
        <span style="color:#66d9ef">background-color</span>: <span style="color:#ae81ff">#000</span>;
        <span style="color:#66d9ef">border</span>: <span style="color:#ae81ff">1</span><span style="color:#66d9ef">px</span> <span style="color:#66d9ef">solid</span>;
    }
&lt;/<span style="color:#f92672">style</span>&gt;</code></pre></td></tr></table>
</div>
</div>
</div>
<div class="paragraph">
<p>This is what the output image looks like:</p>
</div>
<div class="imageblock">
<div class="content">
<img src="/assets/regl_flights.png" alt="regl flights" width="100%">
</div>
<div class="title">Figure 2. Output image</div>
</div>
<div class="paragraph">
<p>Some comments on the code:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>line 24-29: Here we create the actual data to be plotted (see line 67).</p>
<div class="ulist">
<ul>
<li>
<p>You access the values from the 4-element array as <code>x</code>, <code>y</code>, <code>value1</code> and <code>value2</code>. So the 3rd element (i.e. if a flight is domestic or not) is <code>value1</code>.</p>
</li>
</ul>
</div>
</li>
<li>
<p>line 60: I do not have the reticle working yet. For some reason it does not show when set to <code>true</code>.</p>
</li>
<li>
<p>line 52-53: Colour is set by domestic/international, which is in <code>value1</code>. As there are 2 possible values, we set the <code>pointColor</code> as an array with 2 elements.</p>
</li>
<li>
<p>line 54-57: In a similar way we use the distance <code>value2</code> for the radius. Here, we use a function for <code>pointSize</code> instead of a fixed array as for <code>pointColor</code>.</p>
</li>
<li>
<p>line 108: With this subscription we capture the IDs of the selected points which we can use like any reactive variable in svelte. The events that can be trigged with a subscription include <code>select</code>, <code>deselect</code>, <code>pointOver</code> and <code>pointOut</code>, etc. See <a href="https://github.com/flekschas/regl-scatterplot#events">here</a> for a full list.</p>
</li>
</ul>
</div>

    </div>
  </article>

  
  






  <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/posts">Posts</a></li>
         
          <li><a href="/tags">Tags</a></li>
         
          <li><a href="/about">About</a></li>
        
      </ul>
    </div>

    
    <div id="toc-footer" style="display: none">
      
    </div>
    

    <div id="share-footer" style="display: none">
      
      <ul>
  
  
    
  
  
  <li>
    <a class="icon" href="http://www.facebook.com/sharer.php?u=%2fposts%2fscatterplot_in_regl%2f" aria-label="Facebook">
      <i class="fab fa-facebook fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://twitter.com/share?url=%2fposts%2fscatterplot_in_regl%2f&text=Scatterplot%20in%20regl" aria-label="Twitter">
      <i class="fab fa-twitter fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.linkedin.com/shareArticle?url=%2fposts%2fscatterplot_in_regl%2f&title=Scatterplot%20in%20regl" aria-label="Linkedin">
      <i class="fab fa-linkedin fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=%2fposts%2fscatterplot_in_regl%2f&is_video=false&description=Scatterplot%20in%20regl" aria-label="Pinterest">
      <i class="fab fa-pinterest fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="mailto:?subject=Scatterplot%20in%20regl&body=Check out this article: %2fposts%2fscatterplot_in_regl%2f" aria-label="Email">
      <i class="fas fa-envelope fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://getpocket.com/save?url=%2fposts%2fscatterplot_in_regl%2f&title=Scatterplot%20in%20regl" aria-label="Pocket">
      <i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://reddit.com/submit?url=%2fposts%2fscatterplot_in_regl%2f&title=Scatterplot%20in%20regl" aria-label="reddit">
      <i class="fab fa-reddit fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="http://www.tumblr.com/share/link?url=%2fposts%2fscatterplot_in_regl%2f&name=Scatterplot%20in%20regl&description=During%20our%20biological%20data%20visualisation%20workshop%20at%20the%20EBI%20I%20was%20made%20aware%20of%20a%20javascript%20library%20that%20makes%20it%20straightforward%20to%20create%20scatterplots%20of%20large%20datasets.%20How%20large%3f%20The%20demo%20at%20https%3a%2f%2fflekschas.github.io%2fregl-scatterplot%2f%20includes%20an%20example%20of%2020M%20datapoints.%20That%20library%20is%20regl-scatterplot%20which%20is%20available%20at%20https%3a%2f%2fgithub.com%2fflekschas%2fregl-scatterplot%2c%20and%20based%20on%20regl%20which%20%22simplifies%20WebGL%20programming%20by%20removing%20as%20much%20shared%20state%20as%20it%20can%20get%20away%20with%22.%0a%20%20Figure%201." aria-label="Tumblr">
      <i class="fab fa-tumblr fa-lg" aria-hidden="true"></i>
    </a>
  </li>
  <li>
    <a class="icon" href="https://news.ycombinator.com/submitlink?u=%2fposts%2fscatterplot_in_regl%2f&t=Scatterplot%20in%20regl" aria-label="Hacker News">
      <i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i>
    </a>
  </li>
</ul>

    </div>

    <div id="actions-footer">
      
        <a id="menu-toggle" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;" aria-label="Menu">
          <i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        
        <a id="toc-toggle" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;" aria-label="TOC">
          <i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        
        <a id="share-toggle" class="icon" href="#" onclick="$('#share-footer').toggle();return false;" aria-label="Share">
          <i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" aria-label="Top of Page">
          <i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>


  <footer id="footer">
  <div class="footer-left">
    Copyright  &copy; 2023  Saaientist 
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
        <li><a href="/">Home</a></li>
         
        <li><a href="/posts">Posts</a></li>
         
        <li><a href="/tags">Tags</a></li>
         
        <li><a href="/about">About</a></li>
        
      </ul>
    </nav>
  </div>
</footer>


  </div>
</body>

<link rel="stylesheet" href=/lib/font-awesome/css/all.min.css>
<script src=/lib/jquery/jquery.min.js></script>
<script src=/js/main.js></script>

<script src=/js/code-copy.js></script>




</html>
